# GraphNN-VR: åŸºäºå›¾ç¥ç»ç½‘ç»œçš„VRæ•™å­¦ç³»ç»Ÿ

[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.2+-red.svg)](https://pytorch.org/)
[![PyTorch Geometric](https://img.shields.io/badge/PyTorch%20Geometric-2.5+-green.svg)](https://pytorch-geometric.readthedocs.io/)

åŸºäºå›¾ç¥ç»ç½‘ç»œ(GNN)çš„VRæ•™å­¦ç³»ç»Ÿï¼Œå®ç°æ•™å¸ˆä¸å­¦å‘˜ååŒæ§åˆ¶è™šæ‹Ÿè§’è‰²ã€‚é€šè¿‡åŠ¨æ€æƒé‡è°ƒæ•´ï¼Œä¼˜åŒ–å­¦å‘˜åŠ¨ä½œè·Ÿéšæ•ˆæœï¼Œæœ€ç»ˆæå‡å­¦å‘˜åŠ¨ä½œå‡†ç¡®æ€§ã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªåŸºäºå›¾ç¥ç»ç½‘ç»œçš„å®æ—¶VRæ•™å­¦ç³»ç»Ÿï¼Œèƒ½å¤Ÿæ ¹æ®å­¦å‘˜è¾“å…¥æ•°æ®é¢„æµ‹æ•™å¸ˆåŠ¨ä½œã€‚ç³»ç»Ÿå…·æœ‰åŠ¨æ€æƒé‡è°ƒæ•´åŠŸèƒ½ï¼Œä¼˜åŒ–æ•™å¸ˆæŒ‡å¯¼ä¸å­¦å‘˜è‡ªä¸»æ€§ä¹‹é—´çš„å¹³è¡¡ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **å®æ—¶é¢„æµ‹**: åŸºäºå­¦å‘˜è¿‡å»1ç§’ï¼ˆ50å¸§ï¼‰æ•°æ®ï¼Œé¢„æµ‹æ•™å¸ˆæœªæ¥ä½ç½®å’Œæ—‹è½¬
- **åŠ¨æ€æƒé‡è°ƒæ•´**: æ ¹æ®æ‰‹éƒ¨è·ç¦»åç§»è‡ªåŠ¨è°ƒèŠ‚æƒé‡ï¼ˆå­¦å‘˜æƒé‡â†‘è‹¥åç§»â†‘ï¼Œä¿æŒæƒé‡å’Œ=1ï¼‰
- **é«˜ç²¾åº¦**: è¾¾åˆ°â‰¥95%å‡†ç¡®ç‡ï¼Œæ¨ç†å»¶è¿Ÿ<40ms
- **å¤šæ¨¡å‹æ”¯æŒ**: åŒ…å«GNNã€LSTMå’ŒGCNåŸºçº¿å®ç°
- **å…¨é¢å¯è§†åŒ–**: è½¨è¿¹å¯¹æ¯”å›¾å’Œæ¶ˆèå®éªŒçƒ­åŠ›å›¾

## ğŸ“Š æ•°æ®è§„æ ¼

### è¾“å…¥æ•°æ®æ ¼å¼
- **é‡‡æ ·é¢‘ç‡**: 50Hz
- **å•å¸§æ•°æ®**: 32ç»´å¼ é‡
  - **0-5**: æ‰‹éƒ¨ä½ç½®ï¼ˆ6ç»´ï¼‰- [å·¦æ‰‹X, Y, Z, å³æ‰‹X, Y, Z]
  - **6-13**: æ‰‹éƒ¨æ—‹è½¬ï¼ˆ8ç»´ï¼‰- [å·¦æ‰‹å››å…ƒæ•°x,y,z,w, å³æ‰‹å››å…ƒæ•°x,y,z,w]
  - **14-19**: æ‰‹éƒ¨é€Ÿåº¦ï¼ˆ6ç»´ï¼‰- [å·¦æ‰‹é€Ÿåº¦X,Y,Z, å³æ‰‹é€Ÿåº¦X,Y,Z]
  - **20-25**: å½“å‰ç›®æ ‡çƒè·ç¦»ï¼ˆ6ç»´ï¼‰- [å·¦æ‰‹åˆ°çƒX,Y,Z, å³æ‰‹åˆ°çƒX,Y,Z]
  - **26-31**: ä¸‹ä¸€ä¸ªç›®æ ‡çƒåç§»ï¼ˆ6ç»´ï¼‰- [å·¦æ‰‹åç§»X,Y,Z, å³æ‰‹åç§»X,Y,Z]

### æ•°æ®å½’ä¸€åŒ–
- æ‰€æœ‰ä½ç½®ã€é€Ÿåº¦ã€è·ç¦»ã€åç§»é‡å‡é™¤ä»¥RADIUSï¼ˆ150cmï¼‰å®ç°å½’ä¸€åŒ–
- æ¬§æ‹‰è§’è½¬æ¢ä¸ºå››å…ƒæ•°ï¼Œé¡ºåºä¸º[x, y, z, w]

### æ•°æ®é›†ç»“æ„
```
data/
â”œâ”€â”€ processed/          # å¤„ç†åçš„.ptæ–‡ä»¶
â”‚   â”œâ”€â”€ Data_CYJ_J/
â”‚   â”‚   â”œâ”€â”€ player_0_All.pt  # æ•™å¸ˆæ•°æ®
â”‚   â”‚   â””â”€â”€ player_1_All.pt  # å­¦å‘˜æ•°æ®
â”‚   â””â”€â”€ ... (25ä¸ªæ•°æ®é›†)
â””â”€â”€ raw/               # åŸå§‹JSONæ•°æ®
    â”œâ”€â”€ Data_CYJ_J/
    â”œâ”€â”€ Data_GWX_J/
    â””â”€â”€ ... (25ä¸ªå‚ä¸è€…)
```

## ğŸš€ å®‰è£…

### ç¯å¢ƒè¦æ±‚
- Python 3.10+
- CUDAå…¼å®¹GPUï¼ˆå¯é€‰ï¼Œç”¨äºåŠ é€Ÿï¼‰

### ä½¿ç”¨Poetryï¼ˆæ¨èï¼‰
```bash
# å®‰è£…Poetryï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰
curl -sSL https://install.python-poetry.org | python3 -

# å…‹éš†ä»“åº“
git clone <repository-url>
cd GraphNN-VR-v5.2

# å®‰è£…ä¾èµ–
poetry install

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
poetry shell
```

### ä½¿ç”¨pip
```bash
# å…‹éš†ä»“åº“
git clone <repository-url>
cd GraphNN-VR-v5.2

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install torch torch-geometric numpy tqdm hydra-core matplotlib
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
GraphNN-VR-v5.2/
â”œâ”€â”€ graphnn/                    # ä¸»åŒ…
â”‚   â”œâ”€â”€ data/                   # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ dataset.py         # æ•°æ®é›†ç±»
â”‚   â”‚   â”œâ”€â”€ preprocess.py      # æ•°æ®é¢„å¤„ç†
â”‚   â”‚   â””â”€â”€ gen_mean_std.py    # ç»Ÿè®¡ç”Ÿæˆ
â”‚   â”œâ”€â”€ train/                  # è®­ç»ƒè„šæœ¬
â”‚   â”‚   â”œâ”€â”€ gnn_vr_2.py       # ä¸»GNNè®­ç»ƒ
â”‚   â”‚   â”œâ”€â”€ improved_train_gnn_vr.py
â”‚   â”‚   â”œâ”€â”€ gru.py             # GRUåŸºçº¿
â”‚   â”‚   â””â”€â”€ lstm.py            # LSTMåŸºçº¿
â”‚   â”œâ”€â”€ engine/                 # æ¨¡å‹å’Œæ¨ç†
â”‚   â”‚   â”œâ”€â”€ model.py           # æ¨¡å‹æ¶æ„
â”‚   â”‚   â”œâ”€â”€ eval.py            # è¯„ä¼°æŒ‡æ ‡
â”‚   â”‚   â””â”€â”€ infer_sliding_gnn.py  # æ¨ç†å¼•æ“
â”‚   â”œâ”€â”€ server/                 # å®æ—¶æœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ gnn_socket.py      # GNNæ¨ç†æœåŠ¡å™¨
â”‚   â”‚   â””â”€â”€ ue_socket.py       # UE4é€šä¿¡
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·
â”‚   â”‚   â”œâ”€â”€ metrics.py         # æ€§èƒ½æŒ‡æ ‡
â”‚   â”‚   â””â”€â”€ smooth.py          # æ•°æ®å¹³æ»‘
â”‚   â””â”€â”€ viz/                    # å¯è§†åŒ–
â”‚       â”œâ”€â”€ plot_traj_all.py   # è½¨è¿¹ç»˜åˆ¶
â”‚       â””â”€â”€ plot_convergence.py # è®­ç»ƒæ”¶æ•›
â”œâ”€â”€ data/                       # æ•°æ®ç›®å½•
â”œâ”€â”€ docs/                       # æ–‡æ¡£
â”œâ”€â”€ logs/                       # è®­ç»ƒæ—¥å¿—
â”œâ”€â”€ outputs/                    # æ¨¡å‹è¾“å‡º
â””â”€â”€ scripts/                    # å·¥å…·è„šæœ¬
```

## ğŸ® ä½¿ç”¨æ–¹æ³•

### æ•°æ®é¢„å¤„ç†
```bash
# é¢„å¤„ç†åŸå§‹æ•°æ®
python -m graphnn.data.preprocess

# ç”Ÿæˆå½’ä¸€åŒ–ç»Ÿè®¡
python -m graphnn.data.gen_mean_std
```

### æ¨¡å‹è®­ç»ƒ

#### GNNæ¨¡å‹ï¼ˆä¸»è¦ï¼‰
```bash
# è®­ç»ƒGNNæ¨¡å‹
python -m graphnn.train.gnn_vr_2

# è®­ç»ƒæ”¹è¿›ç‰ˆGNN
python -m graphnn.train.improved_train_gnn_vr
```

#### åŸºçº¿æ¨¡å‹
```bash
# è®­ç»ƒLSTMåŸºçº¿
python -m graphnn.train.lstm

# è®­ç»ƒGRUåŸºçº¿
python -m graphnn.train.gru
```

### è¯„ä¼°
```bash
# è¯„ä¼°æ¨¡å‹æ€§èƒ½
python -m graphnn.engine.eval

# è¿è¡Œæ»‘åŠ¨çª—å£æ¨ç†
python -m graphnn.engine.infer_sliding_gnn
```

### å®æ—¶æœåŠ¡å™¨
```bash
# å¯åŠ¨GNNæ¨ç†æœåŠ¡å™¨
python -m graphnn.server.gnn_socket

# å¯åŠ¨UE4é€šä¿¡æœåŠ¡å™¨
python -m graphnn.server.ue_socket
```

### å¯è§†åŒ–
```bash
# ç»˜åˆ¶è½¨è¿¹å¯¹æ¯”
python -m graphnn.viz.plot_traj_all

# ç»˜åˆ¶è®­ç»ƒæ”¶æ•›
python -m graphnn.viz.plot_convergence
```

## ğŸ¯ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å½“å‰çŠ¶æ€ |
|------|--------|----------|
| å‡†ç¡®åº¦ | â‰¥95% | âœ… |
| æ¨ç†å»¶è¿Ÿ | <40ms | âœ… |
| æ¨¡å‹å¤§å° | ä¼˜åŒ– | âœ… |

### åŸºçº¿å¯¹æ¯”
- **GNN**: åŸºäºå›¾æ¶æ„çš„ä¸»è¦æ¨¡å‹
- **LSTM**: ç”¨äºå¯¹æ¯”çš„åºåˆ—åŸºçº¿
- **GCN**: å›¾å·ç§¯ç½‘ç»œåŸºçº¿

## ğŸ”§ é…ç½®

é¡¹ç›®ä½¿ç”¨Hydraè¿›è¡Œé…ç½®ç®¡ç†ã€‚å…³é”®é…ç½®æ–‡ä»¶ä½äºè®­ç»ƒè„šæœ¬ä¸­ï¼Œå¯ä»¥ä¸ºä¸åŒå®éªŒè¿›è¡Œè‡ªå®šä¹‰ã€‚

### å…³é”®å‚æ•°
- **åºåˆ—é•¿åº¦**: 50å¸§ï¼ˆ1ç§’ï¼‰
- **é¢„æµ‹èŒƒå›´**: æœªæ¥ä½ç½®å’Œæ—‹è½¬
- **æƒé‡è°ƒæ•´**: åŸºäºåŸºçº¿åç§»çš„åŠ¨æ€è°ƒæ•´
- **å½’ä¸€åŒ–åŠå¾„**: 150cm

## ğŸ“ˆ ç»“æœ

### è½¨è¿¹é¢„æµ‹
ç³»ç»ŸæˆåŠŸä»¥é«˜ç²¾åº¦é¢„æµ‹æ•™å¸ˆåŠ¨ä½œï¼Œå®ç°VRç¯å¢ƒä¸­çš„å¹³æ»‘ååŒæ§åˆ¶ã€‚

### æƒé‡è°ƒæ•´
åŠ¨æ€æƒé‡è°ƒæ•´ç¡®ä¿åŸºäºæ€§èƒ½æŒ‡æ ‡çš„æ•™å¸ˆæŒ‡å¯¼ä¸å­¦å‘˜è‡ªä¸»æ€§ä¹‹é—´çš„æœ€ä½³å¹³è¡¡ã€‚

## ğŸ¤ è´¡çŒ®

1. Fork ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ LICENSE æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- VRæ•™å­¦ç³»ç»Ÿç ”ç©¶å›¢é˜Ÿ
- PyTorch Geometric ç¤¾åŒº
- æ‰€æœ‰è´¡çŒ®è€…å’Œæµ‹è¯•è€…

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜å’Œæ”¯æŒéœ€æ±‚ï¼Œè¯·åœ¨GitHubä¸Šå¼€å¯issueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚

---

**æ³¨æ„**: æœ¬é¡¹ç›®ä¸“ä¸ºVRæ•™å­¦åº”ç”¨è®¾è®¡ï¼Œéœ€è¦é€‚å½“çš„VRç¡¬ä»¶å’Œè½¯ä»¶æ‰èƒ½å®ç°å®Œæ•´åŠŸèƒ½ã€‚

## ğŸ“š æŠ€æœ¯æ–‡æ¡£

### æ•°æ®è¯´æ˜
- **åŸå§‹æ•°æ®**: JSONæ ¼å¼ï¼ŒåŒ…å«æ‰‹éƒ¨ä½ç½®ã€æ—‹è½¬ã€é€Ÿåº¦ç­‰ä¿¡æ¯
- **é¢„å¤„ç†**: è½¬æ¢ä¸º32ç»´å¼ é‡ï¼Œå½’ä¸€åŒ–å¤„ç†
- **ä»»åŠ¡åœºæ™¯**: äº”è§’æ˜Ÿè½¨è¿¹è§¦ç¢°ï¼ˆå·¦å³æ‰‹ç›®æ ‡çƒç´¢å¼•å›ºå®šï¼‰

### æ¨¡å‹æ¶æ„
- **å›¾ç¥ç»ç½‘ç»œ**: ä¸»è¦æ¶æ„ï¼Œæ”¯æŒåŠ¨æ€å›¾ç»“æ„
- **æ—¶åºå¤„ç†**: 50å¸§æ»‘åŠ¨çª—å£
- **æƒé‡è°ƒèŠ‚**: åŸºäºåç§»åŒºé—´çš„è‡ªåŠ¨è°ƒæ•´

### å¼€å‘é‡Œç¨‹ç¢‘
- **4.6-4.13**: GNNæ¨¡å‹æ¶æ„è®¾è®¡å’ŒåŸºç¡€ä»£ç å®ç°
- **4.14-4.20**: æ•°æ®æ¸…æ´—ä¸æ¨¡å‹è®­ç»ƒ
- **4.21-4.27**: è¶…å‚æ•°è°ƒä¼˜å’Œæ€§èƒ½æµ‹è¯•

### äº¤ä»˜ç‰©
1. **æ¨¡å‹è®¾è®¡**: æ¶æ„ç¤ºæ„å›¾ï¼ˆå«æ•°æ®æµä¸æ¨¡å—è¯´æ˜ï¼‰
2. **æ€§èƒ½æŠ¥å‘Š**: å‡†ç¡®ç‡/F1/æ··æ·†çŸ©é˜µ
3. **ä»£ç ä¸æ•°æ®**: æ¸…æ´—åæ•°æ®é›†ã€è®­ç»ƒä»£ç ã€æƒé‡è°ƒæ•´æ¨¡å—
4. **å¯è§†åŒ–ç»“æœ**: è½¨è¿¹å¯¹æ¯”åŠ¨ç”»/GIFã€æ¶ˆèå®éªŒè´¡çŒ®åº¦å›¾è¡¨ 